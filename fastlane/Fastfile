default_platform(:ios)

desc "Runs the unit tests to ensure the build is working"
lane :test do
  scan(scheme: "TOReachabilityTests", devices: ["iPhone SE"], clean: true)
end

desc "Cuts a new release and distributes it on CocoaPods and Carthage"
lane :release do

  # Fetch the latest tag that would have just been added
  last_tag = last_git_tag
  if !last_tag
    UI.user_error! "--- ERROR: Was unable to locate any git tags. ðŸ¤” ---"
    next
  end

  # Verify the tag conforms to semantic versioning
  if !(last_tag =~ /[vV]?\d{1,3}\.\d{1,3}\.\d{1,3}/)
    UI.success "--- Latest tag doesn't appear to be a new version. Ignoring. ðŸ˜… ---"
    next
  end
end